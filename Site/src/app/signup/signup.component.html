<section class="mx-auto max-w-md">
  <div class="mb-8 text-left">
    <p class="text-xs uppercase tracking-wide text-gray-600">Get started</p>
    <h1 class="mt-2 text-3xl font-semibold text-gray-900">Create Company</h1>
    <p class="mt-2 text-sm text-gray-600">
      We will set up your organization and owner dashboard access in one step.
    </p>
  </div>

  <form class="space-y-6" [formGroup]="form" (ngSubmit)="submit()">
    @if (step === 'details') {
      <label class="block text-sm font-medium text-gray-700">
        Company name
        <input
          class="mt-2 w-full rounded-md border border-gray-300 bg-white px-4 py-2 text-base text-gray-900 outline-none transition focus:border-gray-400 focus:ring-2 focus:ring-gray-200"
          type="text"
          formControlName="companyName"
          autocomplete="organization"
          placeholder="Acme Logistics"
        />
      </label>
    }

    @if (step === 'details') {
      <div class="grid gap-4 sm:grid-cols-2">
        <label class="block text-sm font-medium text-gray-700">
          First name
          <input
            class="mt-2 w-full rounded-md border border-gray-300 bg-white px-4 py-2 text-base text-gray-900 outline-none transition focus:border-gray-400 focus:ring-2 focus:ring-gray-200"
            type="text"
            formControlName="userFirstName"
            autocomplete="given-name"
            placeholder="Sloan"
          />
        </label>

        <label class="block text-sm font-medium text-gray-700">
          Last name
          <input
            class="mt-2 w-full rounded-md border border-gray-300 bg-white px-4 py-2 text-base text-gray-900 outline-none transition focus:border-gray-400 focus:ring-2 focus:ring-gray-200"
            type="text"
            formControlName="userLastName"
            autocomplete="family-name"
            placeholder="Rivera"
          />
        </label>
      </div>

      <label class="block text-sm font-medium text-gray-700">
        Your email
        <input
          class="mt-2 w-full rounded-md border border-gray-300 bg-white px-4 py-2 text-base text-gray-900 outline-none transition focus:border-gray-400 focus:ring-2 focus:ring-gray-200"
          type="email"
          formControlName="userEmail"
          autocomplete="email"
          placeholder="owner@acme.com"
        />
      </label>

      <label class="block text-sm font-medium text-gray-700">
        Password
        <input
          class="mt-2 w-full rounded-md border border-gray-300 bg-white px-4 py-2 text-base text-gray-900 outline-none transition focus:border-gray-400 focus:ring-2 focus:ring-gray-200"
          type="password"
          formControlName="userPassword"
          autocomplete="new-password"
          placeholder="Create a secure password"
        />
      </label>

      <label class="block text-sm font-medium text-gray-700">
        Phone (optional)
        <input
          class="mt-2 w-full rounded-md border border-gray-300 bg-white px-4 py-2 text-base text-gray-900 outline-none transition focus:border-gray-400 focus:ring-2 focus:ring-gray-200"
          type="tel"
          formControlName="userPhone"
          autocomplete="tel"
          placeholder="(555) 123-4567"
        />
      </label>
    } @else {
      <div>
        <p class="text-sm font-medium text-gray-700">Plan</p>
        <div class="mt-2 grid gap-3 sm:grid-cols-3">
          <label
            *ngFor="let plan of planOptions"
            class="flex h-full flex-col gap-2 rounded-md border border-gray-200 bg-white px-4 py-3 text-left text-sm text-gray-700 transition hover:border-gray-300"
          >
            <span class="flex items-start gap-2">
              <input class="mt-1" type="radio" formControlName="tierId" [value]="plan.id" />
              <span class="block text-sm font-semibold text-gray-900">{{ plan.name }}</span>
            </span>
            <span class="text-lg font-semibold text-gray-900">{{ plan.price }} / month</span>
            <span class="block text-xs uppercase tracking-wide text-gray-600">{{ plan.description }}</span>
          </label>
        </div>
      </div>
    }

    <button
      class="w-full rounded-full bg-gray-900 px-4 py-2 text-xs font-semibold uppercase tracking-wide text-white transition hover:bg-gray-800 disabled:cursor-not-allowed disabled:opacity-60"
      type="submit"
      [disabled]="form.invalid || isSubmitting || (step === 'details' && requiresPhoneCode)"
    >
      @if (step === 'details') {
        {{ isSubmitting ? 'Saving details…' : 'Next' }}
      } @else {
        {{ isSubmitting ? 'Redirecting…' : 'Continue to billing' }}
      }
    </button>
  </form>

  <p *ngIf="errorMessage" class="mt-6 rounded-md border border-rose-100 bg-rose-50 px-4 py-3 text-sm text-rose-700">
    {{ errorMessage }}
  </p>

  <div class="mt-8 text-left">
    <p class="text-sm text-gray-600">Already registered?</p>
    <a class="mt-2 inline-flex text-sm font-semibold text-gray-800 hover:text-gray-900" routerLink="/login">
      Back to log in
    </a>
  </div>
</section>
